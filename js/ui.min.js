(function(e){function u(){!s.started()&&o()&&(s.start(),counter.start(),o(!1))}function a(){arguments[0]&&n.html(arguments[0]),arguments[1]&&r.html(arguments[1])}var t,n,r,i,s=e.game;counterFreq=.02,counterTime=0,counter=e.repeater({delay:counterFreq},function(){n.text(counterTime.toFixed(2)),counterTime+=counterFreq});var o=function(){var e=!1;return function(n){if(n==undefined)return e;e=Boolean(n),n?t.fadeIn():t.fadeOut()}}();s.events.on("loaded.core",function(e){t=$("#thumb-button-left, #thumb-button-right"),n=$("#message"),r=$("#counter"),i=$(window),a("beachball madness!","Tilt your device left and right or use the ← and → keys to move the ball."),t.on("click touchup",u).attr("value","start"),i.on("keydown",function(e){switch(e.keyCode){case 37:s.started()||u(),s.pushBeachball("left");break;case 39:s.started()||u(),s.pushBeachball("right")}}),o(!0),s.events.emit("loaded.ui")}),s.events.on("not-loaded",function(e){a(e.reason),o(!1)}),s.events.on("started",function(){o(!1)}),s.events.on("lost",function(e){if(s.started()){s.stop(),counter.stop();var t=e.drawRatio,n=$(window).width();position=e.body.GetPosition();var r=position.x*t<n/2?0:n-$("#splash").width();a(counterTime.toFixed(2),"final time"),counterTime=0,$("#splash").css("bottom","0px").css("left",r+"px").show(100,function(){$(this).fadeOut(800),s.resetBeachball(),o(!0)})}})})(this)
